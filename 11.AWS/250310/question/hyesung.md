## 오늘 뭐가 이해가 안됐어?

자유롭게 서술하시오

- 가상컴퓨터에서 git, node 깐거 mysql 연결하겠는것도 알겠고
- env를 왜깔았는지 이해 완

가상 컴퓨터랑 제 서버 연동되는게 헷갈림  
우리 서버로 3005번대로 열었잖아요  
그래서 http:요청으로 3005번대 인바운드 허용해줌

## **가상 컴퓨터(EC2)와 서버 연동 개념 정리**  

### **1. EC2와 내 서버 연결 개념**  

- EC2는 가상 컴퓨터(서버)이며, 우리가 지정한 **포트(3005)**를 통해 외부에서 요청을 받도록 설정.  
- **3005번 포트에 대한 인바운드 규칙을 열어줘야 요청을 수락 가능**.  

### **2. 방화벽 개념**  

- 기본적으로 EC2에는 **보안 그룹(Security Group)**이 적용되어 있으며, 특정 포트만 허용됨.  
- **SSH (22번 포트)** → 인증된 사용자가 원격으로 접속할 수 있도록 허용.  
- 즉, 인증되지 않은 네트워크 요청은 차단되며, SSH처럼 인증된 네트워크만 허용.  

### **3. HTTP/HTTPS (80, 443번 포트)**  

- **80번 포트** → HTTP 요청을 받는 기본 포트.  
- **443번 포트** → HTTPS(SSL/TLS 암호화된 요청)로 접속하는 포트.  
- 웹사이트는 기본적으로 80번(HTTP) 또는 443번(HTTPS)으로 요청을 받음.  

### **4. 특정 포트(3005) 허용**  

- 우리가 3005번 포트로 API 요청을 받을 예정이라 **인바운드 규칙에서 3005번 포트 허용 필요**.  
- 포트별로 프로세스가 다르므로, 같은 IP라도 포트가 다르면 다른 서비스.  
  - 예) 카카오톡 3005, 버디버디 3004  
- 따라서, **3005번 포트로 들어오는 요청을 허용하는 보안 그룹 설정이 필요**.  

**결론:**  

- **포트(22, 80, 443, 3005 등)에 따라 허용되는 요청이 다름**.  
- **EC2 보안 그룹에서 해당 포트를 열어줘야 정상적인 요청 가능**.  
- **포트가 다르면 같은 IP라도 다른 서비스로 취급됨**.  


### 질문! SSH를 통해 인증된 사용자만 허용시키는거잖아? pem키는 내가 만드는데? 사용자가 만드는게 아니라??? 뭔소리야??? 근데 뭔 사용자를 인증된 사람(네트워크)만 받네 안받네를 하는거임?

**SSH 인증(22번 포트)과 사용자의 인증 개념**을 정확히 이해하면 더 명확해집니다.

## **SSH 인증 과정의 핵심 개념**

- **SSH(22번 포트)는 "인증된 사용자"만 원격 접속을 허용하는 프로토콜**  
- **인증된 사용자**라는 것은 **미리 승인된 인증 방식(키 인증, 비밀번호 인증 등)을 통과한 사용자**  
- AWS EC2에서는 **키 파일(.pem)을 사용한 인증 방식을 적용**  

## **질문: "pem 키는 내가 만드는데, 그럼 내가 인증된 사용자를 정하는 거 아님?"**
맞습니다!  
**pem 키를 만든 사람(EC2 인스턴스를 생성한 사람)이 '인증된 사용자'를 정의하는 것**입니다.  

1.  **EC2를 생성할 때 키 페어(.pem)를 생성**  
   - 이 키 페어는 "나만 사용할 수 있는 SSH 접속 인증 키"  
   - 다른 사람은 이 키 없이 접속 불가능  

2. **SSH 접속 시 pem 키를 사용하여 인증 진행**  
   ```sh
   ssh -i "mykey.pem" ubuntu@ec2-xx-xx-xx-xx.compute.amazonaws.com
   ```
   - `-i "mykey.pem"` → EC2에 접속할 때 이 키를 이용해 인증을 수행  
   - AWS는 **이 키를 가지고 있는 사용자만 '인증된 사용자'로 인정**  
   - 즉, **이 키를 가진 네트워크 요청만 허용됨!**  

**즉, 인증된 네트워크란?**  
**AWS가 허용한 특정 인증 방식(SSH 키 인증)을 통과한 사용자만 접속 가능**  
그냥 아무나 네트워크 요청을 보낼 수 있는 것이 아니라,  
=> **"인증된 사용자가 보낸 네트워크 요청만 허용된다"**는 뜻  

---

## **질문: "사용자를 인증된 사람(네트워크)만 받네 안 받네를 한다는 게 무슨 의미?"**
AWS의 기본 보안 설정이 **"네트워크는 허용된 사용자만 접근 가능"하게 되어 있음**.  
즉, SSH(22번 포트)는 **랜덤한 IP에서 오는 요청을 막고**, **인증된 키를 가진 사람만 허용**.

🛑 **비인가 사용자(인증되지 않은 네트워크)**  
- 키 없이 `ssh ubuntu@ec2-xx-xx-xx-xx.compute.amazonaws.com` 하면?  
- **"Permission denied (publickey)"** 오류 발생  
- AWS는 **이 요청을 인증되지 않은 네트워크 요청**으로 간주하고 차단  

- **인증된 사용자(인증된 네트워크)**  
- `ssh -i "mykey.pem" ubuntu@ec2-xx-xx-xx-xx.compute.amazonaws.com` 하면?  
- **SSH 연결 성공** → 인증된 사용자의 네트워크 요청으로 인정됨  

---

## **핵심 정리**
1. **AWS EC2는 SSH(22번 포트)를 기본적으로 막아두고, 인증된 사용자(키 보유자)만 허용**  
2. **pem 키를 가진 사람만 "인증된 사용자"로 인정됨**  
3. **즉, AWS 보안 설정은 "아무나 네트워크 요청을 보낼 수 없다"는 원칙을 기본으로 둠**  
4. **SSH는 "인증된 사용자(키 보유자)"가 보낸 요청만 "인증된 네트워크 요청"으로 간주하여 허용**  

**쉽게 말하면:**  
"네트워크를 만들었다고 해서 모든 요청을 받을 수 있는 게 아니라,  
AWS는 **인증된 네트워크 요청(키 인증이 통과된 요청)만 받도록 설계되어 있다.**"  

### **질문: "사용자의 주체가 누구인가?"**
➡ **이 질문에서 "사용자"가 의미하는 대상은 "SSH를 통해 EC2에 접속하려는 사람"인가, 아니면 "웹 서비스를 이용하는 최종 사용자"인가?**  

**AWS에서 SSH 인증(22번 포트)과 웹 서비스 이용(80, 443번 포트)은 완전히 다른 개념이므로, 개념을 분리해서 이해해야 합니다.**  

---

## **1️⃣ SSH 인증(22번 포트)에서 "사용자"란?**  
➡ **"개발자(운영자)"**  
SSH(22번 포트)는 **EC2 서버에 직접 접속하여 관리·운영하는 사람(= 개발자, 서버 관리자 등)**이 사용하는 포트입니다.  

🔹 **즉, AWS에서 SSH 인증을 요구하는 사용자는 "서버를 관리하는 개발자"를 의미**  
🔹 이 개발자가 SSH 키(`.pem`)를 사용하여 EC2에 접속하면, AWS는 **"이 개발자가 인증된 사람인지 확인"하는 과정**을 거침.  

**예제: 개발자가 EC2에 SSH 접속할 때**  
```sh
ssh -i "mykey.pem" ubuntu@ec2-xx-xx-xx-xx.compute.amazonaws.com
```
✔️ 여기서 "사용자"는 **EC2 서버에 접근하려는 개발자**를 뜻함.  
✔️ AWS는 EC2 내부의 **`~/.ssh/authorized_keys`** 파일을 확인하여 인증을 수행함.  

**즉, SSH에서 말하는 "사용자"는 개발자나 서버 운영자이고, 이들이 pem 키로 인증을 받아야 접속할 수 있음.**  

---

## **2️⃣ 웹 서비스 이용(80, 443, 3005번 포트)에서 "사용자"란?**  
➡ **"웹 서비스를 이용하는 최종 사용자"**  
- 22번 포트(SSH)는 개발자가 EC2를 관리할 때만 사용하지만,  
- 80, 443, 3005번 포트는 **실제 웹 서비스를 이용하는 사용자(클라이언트, 브라우저, API 요청자 등)**가 접근하는 포트임.  

**웹 서비스 이용자의 요청 예시**  
```sh
curl http://3.3.3.3:3005/api/data
```
✔️ 여기서 "사용자"는 **웹 서비스를 이용하는 클라이언트(브라우저, 모바일 앱, API 요청을 보내는 서버 등)**를 의미.  
✔️ EC2의 방화벽(Security Group)에서 **3005번 포트를 열어줘야 웹 서비스 이용자가 접근 가능**.  

**즉, 80, 443, 3005번 포트는 개발자가 아닌, 실제 웹 서비스 사용자(고객, API 클라이언트)가 이용하는 포트임.**  

---

## **결론: "사용자"의 주체는 맥락에 따라 다름**
| 사용처 | "사용자"의 의미 | 설명 | 
|--------|--------------|------|
| **SSH (22번 포트)** | **개발자, 서버 운영자** | EC2에 직접 접속하여 관리하는 사람 |
| **웹 서비스 (80, 443, 3005번 포트)** | **웹 서비스 이용자 (브라우저, API 클라이언트, 모바일 앱 등)** | 서비스를 사용하는 최종 사용자 |

**즉, "사용자"라는 단어가 나왔을 때, SSH 접속을 말하는지, 웹 서비스 이용을 말하는지에 따라 의미가 다름!**  