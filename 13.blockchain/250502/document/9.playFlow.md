## 9. 전체 실행 흐름 요약

이제 우리가 만든 **Baseball 게임**이 실제로 어떻게 실행되는지  
**전체적인 사용자 흐름**을 따라가며 정리해봅시다.

---

### 1단계: 페이지 접속

사용자가 HTML 페이지를 처음 엽니다.

- 이 시점에서는 아직 아무런 정보도 표시되지 않습니다.
- 우리가 필요한 버튼만을 클릭하면, 해당 이벤트를 등록한 함수가 차례대로 실행하면서 정보가 화면에 출력됩니다.
  → `getAccount()`, `getTicket()`, `getProgress()`, `getReward()`, `getPlaying()`  
  → 스마트 컨트랙트에서 상태값을 읽어와 화면에 보여줍니다.

---

### 2단계: 지갑 연결

```js
connectWallet();
```

- 사용자가 **지갑 연결** 버튼을 누르면
- 메타마스크가 뜨고, 사용자가 계정을 선택합니다.
- 선택된 계정 주소는 화면에 출력됩니다.

> 지갑이 연결되어야 스마트 컨트랙트와 상호작용이 가능합니다.

---

### 3단계: 상태 출력

| 항목     | 설명                           |
| -------- | ------------------------------ |
| Account  | 연결된 지갑 주소               |
| Ticket   | 참여 비용 (0.01 ETH)           |
| Progress | 지금까지 시도한 횟수           |
| Reward   | 누적된 보상금 (오답일 때 누적) |
| Message  | `"게임중"` 또는 `"게임종료"`   |

이 상태들은 모두 스마트 컨트랙트에서 직접 가져오는 값입니다.

---

### 4단계: 입력 시도

```js
gameStart();
```

- 사용자가 숫자를 입력하고 “게임 시작” 버튼을 누릅니다.
- `gameStart()` 함수가 트랜잭션을 생성하여 실행됩니다.
- 이 때 **0.01 ETH가 함께 전송되어야** 트랜잭션이 성공합니다.

> 만약 3자리 숫자가 아니거나  
> 0.01 ETH가 아닌 금액을 전송하면 → `require`에 의해 실패합니다.

---

### 5단계: 결과 판단

컨트랙트에서는 다음 흐름대로 판단합니다:

- `progress < GAME_COUNT` → 아직 기회 남았는가?
- `msg.value == ticket` → 입장료 정확한가?
- `_value == random` → 정답인가?

그에 따라:

| 경우      | 결과                                  |
| --------- | ------------------------------------- |
| 정답 입력 | 보상금 전송 + 상태 초기화 + 게임 종료 |
| 오답 입력 | 보상금 누적 + 진행도 1 증가           |
| 10판 종료 | `getPlaying() == 1`로 게임 종료 상태  |

---

### 6단계: 상태 자동 반영 (렌더링)

트랜잭션이 끝나면 다시 버튼을 눌러서, 내가 원하는 정보를 화면에 출력해봅시다.

---

## 전체 흐름 한눈에 요약

```text
[페이지 접속]
   ↓ 버튼 클릭
[지갑 연결]
   ↓ account 표시
[게임 시도]
   ↓ gameStart() → 트랜잭션 실행
   ↓ 스마트 컨트랙트에서 결과 판정
[화면 상태 갱신]
   ↓ 버튼 클릭으로 최신 상태 출력
[10판 반복 or 정답 도달]
   ↓ 게임 종료
```

---

## 체화 포인트

- 사용자가 페이지에서 **버튼 하나를 누를 때마다**,  
  스마트 컨트랙트에서는 **정확한 조건 검증과 상태 변화**가 일어납니다.

- 이 흐름을 **전체적으로 이해하고** 나면,  
  **“화면에서 보이는 변화”가 스마트 컨트랙트 내부에서 어떤 로직으로 작동했는지**를 연결해서 볼 수 있습니다.

---

다음은 이 흐름을 마무리 짓고,  
이제 우리가 어떤 방식으로 과제를 수행해야 하는지를 안내하겠습니다.
