# P2P 네트워크를 위한 통신 구조 이해하기

## HTTP 통신의 한계

일반적으로 웹에서 사용하는 통신 방식은 HTTP입니다.  
우리가 자주 사용하는 **브라우저와 서버의 통신 방식**이죠.

하지만 HTTP에는 한 가지 **치명적인 특징**이 있습니다.

### 비연결성(Stateless)

- HTTP 요청은 **1회성 통신**입니다.
- 요청을 보내면, 응답을 받고 **연결이 바로 끊깁니다**.
- 다음 요청을 보낼 때는 다시 연결을 열어야 합니다.

이 구조는 웹 사이트처럼 "정보만 주고받는" 구조에 적합하지만,  
**노드 간에 계속 연결되어 있어야 하는 블록체인**에는 어울리지 않습니다.

---

## 질문: 그럼 기존의 우리가 작성하던 HTTP 방식으로는 블록을 전파할 수 없나요?

**할 수는 있습니다.**

HTTP 요청으로도 블록을 전송하고, 체인을 교체할 수 있습니다.  
실제로 우리는 이전 수업에서 `/block/mine`이나 `/chains` 같은 API를 이용해 블록을 만들고 조회했죠.

하지만 다음과 같은 한계가 있습니다:

- HTTP는 **클라이언트가 계속 요청해야**만 데이터를 받을 수 있습니다.
- 즉, **블록을 채굴했다는 소식을 받으려면 내가 계속 요청을 보내야** 한다는 뜻입니다.
- 이런 구조는 **계속 연결을 유지해야 하는 P2P 네트워크**와 맞지 않습니다.

---

## 블록체인 네트워크는 왜 Socket을 선택했을까?

비트코인 네트워크는 다음과 같은 고민을 했습니다.

> “모든 노드가 **동일한 정보를 저장**해야 한다.  
> 누군가 블록을 채굴했다면, **그 즉시 다른 모든 노드에게 전달**되어야 한다.”

그래서 **누가 서버고 누가 클라이언트인지 구분하지 않는 구조**,  
즉 **모든 노드가 서로 연결되어 있는 P2P 구조**를 선택하게 된 겁니다.

### 핵심 개념

- 내가 블록을 채굴했다 → **다른 노드에게 알려야 함**
- 다른 누군가가 블록을 채굴했다 → **나는 그 소식을 바로 받아야 함**
- 그러기 위해선 **지속적인 연결이 유지되어야 함**
- 즉, **서버/클라이언트를 구분하지 않고, 쌍방이 항상 연결된 상태**여야 함

## TCP 통신과 Socket의 등장

TCP는 **연결 지향형 통신**입니다.

- 연결을 맺고 나면, 한쪽이 데이터를 보내면 바로 반대쪽에서 수신할 수 있습니다.
- 블록체인처럼 **실시간으로 소식을 받아야 하는 시스템**에 적합합니다.

여기에 **Socket**을 사용하면:

- TCP 연결을 직접 열고,
- 연결된 상대에게 **바로 데이터를 보낼 수 있는 구조**가 만들어집니다.

> 즉, "블록이 생성되었다"는 소식을 **전 노드에게 직접 전송**할 수 있게 되는 거죠.

## 정리하면

| 구조               | 특징                                                                        |
| ------------------ | --------------------------------------------------------------------------- |
| HTTP               | 요청-응답 기반, 클라이언트가 계속 요청해야 정보 확인 가능                   |
| 블록체인 네트워크  | 누가 먼저 요청하든 관계 없이, **서로가 연결된 상태에서 즉시 전달**되어야 함 |
| P2P + TCP + Socket | 이러한 구조를 만족시키기 위해 채택된 기술 조합                              |

## 그래서 오늘 우리는?

- 기존의 HTTP 기반 요청은 **중앙 서버가 있는 구조**에 적합했고,
- 우리는 이제 **분산된 노드들이 서로 연결된 상태에서 정보를 전파**해야 합니다.
- 오늘 구현하는 **Socket 기반의 P2P 구조**는  
  앞으로 트랜잭션 브로드캐스트, 블록 전파, 체인 동기화의 **출발점**이 됩니다.
