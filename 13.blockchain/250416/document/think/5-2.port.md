# 질문: "근데 배포하면 결국 도메인 하나잖아요? 포트가 왜 필요한 건가요?"

## 먼저 대답부터!

> 맞아요. 실제 배포 환경에서는 보통 하나의 도메인만 사용합니다.  
> 예를 들어 `http://wine.co.kr` 같은 주소 하나죠.

**하지만 그 안에는 여전히 여러 포트에서 작동하는 서버들이 존재하고**,  
그걸 **하나의 도메인으로 통합해서 보여주는 기술**이 존재합니다.

그게 바로 `Proxy(프록시 서버)` 또는 `Load Balancer(로드 밸런서)`입니다.

## 개발 환경 vs 실제 배포 환경

| 항목               | 개발 환경 (`로컬`)                  | 실제 배포 환경 (`운영`)                       |
| ------------------ | ----------------------------------- | --------------------------------------------- |
| 접근 방식          | `localhost:4000`, `localhost:4001`  | `wine.co.kr` 하나의 도메인                    |
| 포트 구분 필요     | O – 노드 2개가 동시에 실행되기 때문 | X – 모든 요청을 **하나의 진입점**으로 모아줌  |
| 내부 구조          | 서버 2개가 따로 있음 (포트로 구분)  | 서버 2개든 10개든 **프록시 서버가 대신 연결** |
| 외부에서 보이는가? | 포트 번호가 그대로 URL에 노출됨     | **URL에는 포트가 드러나지 않음**              |

## 현실적인 예

예를 들어, 아래와 같은 상황을 생각해보자:

- 내부에서 실제 서버는
  - API 서버 → `localhost:4000`
  - 관리자 페이지 서버 → `localhost:3000`
  - 이미지 서버 → `localhost:5000`

근데 사용자 입장에서는 그냥 하나야:

```txt
https://wine.co.kr/api/...
https://wine.co.kr/admin/...
https://wine.co.kr/images/...
```

### 왜냐하면…

> 이 모든 요청을 **중간에 있는 Nginx나 프록시 서버**가  
> 적절한 포트로 **자동으로 라우팅**해주기 때문이야!

---

## 예: Nginx 설정 (간단 개념)

```nginx
server {
  listen 80;
  server_name wine.co.kr;

  location /api/ {
    proxy_pass http://localhost:4000/;
  }

  location /admin/ {
    proxy_pass http://localhost:3000/;
  }

  location /images/ {
    proxy_pass http://localhost:5000/;
  }
}
```

→ 결과적으로 **사용자는 포트를 몰라도 되고**,  
**개발자는 내부에서 포트로 서버를 관리**할 수 있어.

---

## 다시 질문으로 돌아가면

> “왜 우리는 지금 4000번, 4001번 포트를 쓰고 있나요?”

→ 이건 **로컬 개발이기 때문에**,  
**하나의 컴퓨터 안에서 여러 개의 노드를 분리해서 실행**해야 하기 때문이에요.

> “배포하면 결국 하나의 도메인 아닌가요?”

→ 맞습니다.  
하지만 **내부 구조는 여전히 포트로 나뉘어 있을 수 있고**,  
그걸 **도메인 하나로 감싸주는 프록시 기술이 들어갑니다.**

---

## 한 줄 정리

> **개발 중엔 포트로 분리해서 테스트하고,  
> 배포 시엔 프록시 서버를 통해 하나의 도메인으로 통합**합니다.
