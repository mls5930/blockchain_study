# 오늘의 어려움 정리: "블록 채굴 정보는 이미 다 공개된 거 아니에요?"

학생들의 질문은 합리적이었어요.

> “difficulty랑 nonce는 이미 다 알고 있는 거 아닌가요?”  
> “남들이 내가 채굴하려는 블록의 정보 다 볼 수 있는 거 아니에요?”  
> “그럼 블록 해킹도 가능한 거 아닌가요?”

이 질문들을 제대로 이해하려면 **"채굴의 흐름"과 "P2P 네트워크의 구조"**, 그리고 **로컬 작업 vs 네트워크 공유 정보**에 대한 구분이 필요합니다.

## 기본 개념 먼저 정리

### 1. `nonce`란 무엇인가?

- `nonce`는 블록의 해시값이 특정 조건(예: 앞에 0이 몇 개 있어야 한다)을 만족할 때까지 **시도한 횟수**를 나타냅니다.
- 즉, **블록을 채굴하는 동안 무수히 많은 nonce 값을 대입해보며 시도**하는 것입니다.
- 이미 정해진 값이 아니라, **채굴이 성공되었을 때 ‘이게 정답이다!’ 하고 알게 되는 값**입니다.

=> `nonce는 “정답”이 아니라, “찾아가는 값”이에요.`

---

### 2. 남들이 내가 채굴 중인 블록의 내용을 볼 수 있을까?

**볼 수 없습니다.**

이건 **블록체인의 네트워크 구조**와 관련된 내용입니다. 블록은 이런 과정을 거칩니다:

---

## 채굴 과정 요약

1. **블록 후보 생성**

   - 각 노드(개인 컴퓨터)는 스스로 새로운 블록을 만들기 시작합니다.
   - 이때 자신이 보관하고 있는 **트랜잭션 풀 (mempool)** 에서 트랜잭션을 고릅니다.

2. **로컬 환경에서 채굴 진행**

   - 선택한 트랜잭션들과 이전 블록의 해시, difficulty 등을 바탕으로 블록 헤더를 구성하고 nonce를 바꾸며 채굴을 시도합니다.
   - 이 과정은 **로컬 컴퓨터 내부에서만 진행**됩니다.
   - 이 시점에서는 **다른 노드들은 이 블록의 정보에 접근할 수 없습니다.**

3. **채굴 성공**

   - 올바른 nonce 값을 찾으면, 블록의 해시가 조건을 만족합니다.
   - 이때 **해당 블록 전체를 P2P 네트워크에 브로드캐스트** 합니다.

4. **다른 노드들이 검증**
   - 다른 노드들은 블록을 받고, 안에 있는 트랜잭션, 블록 해시, nonce 등이 맞는지 검증합니다.
   - 검증이 끝나면, 해당 블록을 블록체인에 추가합니다.

## 왜 블록 후보는 남들이 볼 수 없나요?

- **로컬에서만 조합**하고, 채굴 성공 전에는 외부로 정보가 나가지 않기 때문입니다.
- **P2P 네트워크**는 정보를 "발표"할 때만, 즉 채굴 성공 후에만 공유합니다.
- 마치 시험 문제를 혼자 풀다가, 정답을 맞히면 친구들에게 “나 맞췄어!” 하며 보여주는 느낌이에요.

---

## 추가로 이해하면 좋은 개념

### P2P와 Socket

- **P2P (Peer to Peer)**는 중앙 서버 없이 각 노드가 서로 직접 통신하는 구조입니다.
- **Socket**은 이런 네트워크 상에서 정보를 보내고 받는 통로 역할을 합니다.
- P2P에서 블록이 전파되는 것도, **socket 통신을 통해 이뤄집니다.**

그래서 학생들은 앞으로 `socket` 개념을 공부해야 합니다. (안 하면 죽임(?))  
→ 그래야 왜 정보가 공개되기 전에는 외부에 보이지 않는지도 정확히 이해할 수 있습니다.

## 정리 요약

| 항목          | 내용                                                      |
| ------------- | --------------------------------------------------------- |
| `nonce`       | 채굴을 위해 시도하는 숫자. 이미 정해진 값이 아님.         |
| 블록 후보     | 각 노드가 로컬에서 생성. 채굴 성공 전에는 외부에 안 보임. |
| 트랜잭션 선택 | 로컬 mempool에서 가져오며, 공유되지 않음.                 |
| P2P 네트워크  | 채굴 성공 후에만 블록을 전체에 알림.                      |
| socket        | 노드 간 통신을 가능하게 하는 기술. P2P의 핵심 도구.       |

---

## 예시 질문: 학생들이 할 수 있는 질문 정리

> “블록 후보 만들 때 내 트랜잭션 누가 봐요?”  
> 👉 아무도 못 봐요. 본인 컴퓨터에서만 작업 중이에요.

> “트랜잭션을 가져온다는 건 무슨 뜻이에요?”  
> 👉 내가 보유한 mempool(트랜잭션 풀)에서 가져오는 거예요.  
> 그걸 블록에 담는 거고요.
