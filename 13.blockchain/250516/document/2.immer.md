# **블록체인은 왜 ‘불변성’을 강제로 요구할까?**

이제 질문을 던져봅시다.  
왜 스마트 컨트랙트는 한 번 배포되면 영원히 그 모습 그대로 남아야 할까요?

이 질문을 이해하려면, 먼저 **‘배포(deploy)’라는 행위가 무엇인지**부터 살펴봐야 합니다.

## **배포란 무엇인가?**

우리가 Remix에서 `Deploy` 버튼을 누를 때,  
EVM은 단순히 코드를 저장하는 것이 아닙니다.

블록체인 네트워크는  
그 코드를 **영원히 지워지지 않는 주소에 각인**합니다.  
그 주소는 그냥 랜덤하게 생성되는 게 아닙니다.

이 주소는 아래 두 가지 정보에서 파생됩니다:

## **CA = codeHash + storageRoot**

EVM에서 하나의 컨트랙트는 내부적으로 이렇게 정의됩니다:

> **CA (Contract Account) = 코드 해시(codeHash) + 저장소 뿌리(storageRoot)**

- `codeHash`: 배포된 스마트 컨트랙트의 바이트코드를 해시한 값
- `storageRoot`: 해당 컨트랙트의 저장소 상태를 관리하는 Merkle Patricia Trie의 루트

즉, **코드가 다르면 주소도 달라집니다.**  
심지어 단 한 줄만 바뀌어도,  
EVM은 전혀 새로운 컨트랙트로 인식합니다.

## **코드가 바뀌면 신뢰가 깨진다 → 그래서 영원히 못 바꾸게 한다**

이 구조는 무섭도록 단단합니다.  
사용자가 어떤 컨트랙트에 돈을 보낼 때,  
그 주소 안의 코드가 **영원히 변하지 않을 것**을 믿고 보냅니다.

만약 누군가가 계약 코드를 바꾸면 어떻게 될까요?

- 이미 서명한 계약의 내용이 뒤바뀌게 됩니다.
- 사용자 자산이 사라지거나, 예상치 못한 동작이 발생할 수 있습니다.
- 블록체인의 핵심인 “코드에 의한 신뢰”가 무너집니다.

그래서 블록체인은 말합니다.  
**“한 번 배포한 코드는 바꿀 수 없다.”**

신뢰를 유지하기 위한 전제 조건.

## **비트코인의 UTXO와 같은 원리: → 상태가 아닌, “행위의 누적”만을 기억한다**

이런 불변성은 비트코인에도 동일하게 적용됩니다.  
비트코인은 **계정(Account)** 기반이 아니라  
**UTXO (Unspent Transaction Output)** 기반입니다.

무슨 차이일까요?

- 비트코인은 상태를 기억하지 않습니다.
- 대신, 이전에 어떤 트랜잭션이 있었고,
  그로 인해 어떤 Output이 남았는지만 기록합니다.

즉, 현재의 "내 잔액"을 따지기보다는  
"어떤 행동들이 있었고, 그 결과 어떤 출력이 남았는가"를 기억하는 구조입니다.

**→ "상태"가 아니라, "행위의 누적"을 저장하는 구조**

이 구조는 블록체인의 전반적인 철학과도 맞닿아 있습니다.  
바로, **“신뢰는 기록된 행위로부터 온다”**는 믿음이죠.

---

그리고 바로 이 원칙이,  
스마트 컨트랙트가 쉽게 바뀔 수 없도록 만든  
가장 근본적인 이유입니다.

**우리는 과거를 지우지 않기로 한 세계에 살고 있습니다.**  
그렇다면… 변화는 어떻게 가능할까요?

그 답이 바로 **Proxy 패턴**입니다.  
로직은 바꿀 수 있지만, 상태는 남겨두는 방법.  
다음 장에서 그것을 살펴봅니다.
