# 7단계: 전체 흐름 통합 후 테스트

> **블록을 생성하면, 실시간으로 전파되는지 확인해봅시다**

## 지금까지 만든 구조, 한번 떠올려 봅시다

우리는 지금까지 다음과 같은 시스템을 직접 구성해왔어요:

1. 각 노드가 서버를 실행하고
2. 블록을 생성하면 체인이 바뀌고
3. 그 체인 변경이 `.emit()` 이벤트로 발생하며
4. 연결된 WebSocket을 통해 브라우저로 전달되고
5. 브라우저에서는 `.onmessage()`로 그걸 받아
6. **즉시 화면에 실시간 반영**

이제, 이 전체 흐름이 **정말 연결되어 있는지**  
눈으로 직접 확인해볼 차례입니다.

## 실습 조건

- 두 개의 터미널에서 `node1`, `node2` 실행
- 브라우저는 `http://localhost:4001` 열기
- 다른 탭에서 `http://localhost:4000` 열기

(여기서 4001이 실시간 반영을 보여주는 브라우저 탭이라고 가정합니다.)

---

## 실습 흐름

1. 브라우저에서 `블록 생성` 버튼을 클릭합니다  
   → 4000번 서버에 POST 요청이 날아감

2. `client.connect()`를 통해  
   → 4000 → 4001로 블록 전파됨 (P2P)

3. 4001의 체인이 바뀜  
   → `.emit("chainUpdated")` 발생

4. WebSocket을 통해 브라우저에게 메시지 전송  
   → `.onmessage()`에서 받은 후 화면에 반영

## 확인할 수 있는 현상

- 아무것도 새로고침하지 않았는데
- **다른 탭의 화면이 자동으로 바뀐다**

이 순간, 우리는 정말 **"분산 네트워크가 동작하고 있다"**는 걸 체험하게 됩니다.

## 학생들에게 강조하면 좋은 말

> 여러분, 이건 단순한 프론트/백엔드 통신이 아닙니다.  
> **내가 만든 블록이 다른 노드로 전파되고,  
> 그 노드가 체인을 갱신하고,  
> 그 결과가 실시간으로 사용자에게 반영되는 것.**  
> 이게 바로 블록체인의 **전파 구조를 시뮬레이션한 것**입니다.

## 이 단계의 진짜 목적

> **“우리가 만든 시스템이 단절 없이 유기적으로 이어지는 구조다”**  
> 라는 걸 확인하는 데에 있어요.

## 실습 팁

- 블록 생성 후 `blockListView` 영역을 계속 관찰해보세요
- 다른 브라우저 탭에서도 동시에 보면서 변화가 실시간으로 반영되는지 확인
- 하나의 브라우저 탭만 열었을 땐 WebSocket 연결 대상만 반응합니다

## 한 줄 요약

> **“이제부터는 내 코드가 하나의 네트워크처럼 동작한다.”**  
> 그걸 **눈으로 확인하는 마지막 단계**입니다.
