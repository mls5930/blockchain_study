# 잠깐! 우리가 쓴 `web3.utils`는 도대체 뭐죠?

우리가 스마트 컨트랙트를 호출할 때,  
이런 코드를 사용했었습니다:

```js
value: web3.utils.toWei("0.01", "ether");
```

그럼 여기서 궁금한 게 생기죠.

> “web3는 알겠어요. 블록체인이랑 연결하는 도구니까.  
> 근데 **`utils`**는 뭐고, 왜 여기에 필요한 거죠?”

## 먼저 질문부터 던져봅시다

자바스크립트는 **기본적으로 블록체인의 단위를 이해하지 못합니다.**

- `0.01` ETH를 그냥 숫자로 쓰면? → 부동소수점 오차 발생 가능성 있음
- `123456789123456789123456789`처럼 긴 숫자? → 자바스크립트에서 정확하게 표현 불가능
- 해시, 주소, 이더 단위, 바이트 배열, 바이트 변환 등등…  
  → JS에서는 일일이 직접 구현하기 어려움

## 그래서 등장한 도구가 바로 `web3.utils`

> **`web3.utils`는 블록체인과의 데이터 호환을 도와주는 도구함(toolbox)입니다.**

이걸 조금 더 현실적으로 말하면:

> **JS가 블록체인에서 사용하는 형식(단위, 숫자, 해시, 주소 등)을 제대로 다룰 수 있도록 도와주는 유틸 모음입니다.**

## 어떤 관점으로 바라봐야 할까?

> **web3.utils는 "블록체인의 언어를 자바스크립트가 이해하게 도와주는 번역기"입니다.**

블록체인은 이렇게 말합니다:

- "나한테 보내려면 wei 단위로 숫자 줘!"
- "이 주소 맞는지 체크할 수 있어?"
- "이 값을 keccak256으로 해시해봐"
- "이 바이트 배열을 hex 문자열로 바꿔줘"

자바스크립트는 이렇게 말합니다:

- "어... 난 그냥 0.01 이더라고 적었는데...?"
- "이거 숫자인지 문자열인지 모르겠는데?"
- "문자열 암호화? 그런 거 내장 안 되어 있어..."

그래서 둘 사이에서 **통역사 역할**을 하는 게 바로 `web3.utils`입니다.

## 주요 기능 예시

| 함수명        | 역할 설명                                       |
| ------------- | ----------------------------------------------- |
| `toWei()`     | ETH 단위를 Wei로 변환 (소수 → 정수)             |
| `fromWei()`   | Wei 단위를 사람이 읽기 쉬운 ETH로 변환          |
| `isAddress()` | 이 문자열이 올바른 이더리움 주소인지 검사       |
| `sha3()`      | 문자열을 keccak256 해시로 변환                  |
| `hexToUtf8()` | 헥스 문자열을 사람이 읽을 수 있는 문자열로 변환 |
| `padLeft()`   | 고정된 길이만큼 왼쪽에 0을 채워주는 형식화 도구 |

## toWei는 왜 여기에 있을까?

이제 이해가 되죠.  
`toWei()`는 단순한 도우미 함수가 아니라,  
**자바스크립트가 블록체인이 원하는 '정확한 숫자 단위'로 값을 변환하기 위해 꼭 필요한 통역도구**입니다.

# 그럼 이제 `toWei("0.01", "ether")`를 살펴봅시다

자, 우리가 앞서 본 코드였죠?

```js
value: web3.utils.toWei("0.01", "ether");
```

이 코드는 **사용자가 입력한 금액(0.01 ETH)**을  
스마트 컨트랙트가 처리할 수 있게 **정확한 단위(Wei)**로 변환하는 과정입니다.

## 왜 변환해야 하나요?

블록체인에서는 숫자를 **실수(float)**로 다룰 수 없습니다.  
오직 **정수(integer)**만 가능합니다.

> "0.01"이라는 숫자도  
> 블록체인 입장에서는 → 에러를 유발할 수 있는 애매한 값입니다.

그래서 이걸 명확한 단위인 **Wei**로 바꿔줘야 합니다.

## ETH → Wei 변환 규칙

> **1 ETH = 1,000,000,000,000,000,000 Wei (10¹⁸ Wei)**

즉,

- `1` ETH → `1000000000000000000` Wei
- `0.1` ETH → `100000000000000000` Wei
- `0.01` ETH → `10000000000000000` Wei

그럼 우리가 0.01 ETH를 보낸다고 할 때  
자바스크립트가 직접 이걸 계산해줄 수 있을까요?

가능하긴 하지만 **실수 오차**도 있고, **가독성도 떨어집니다.**

## 그래서 등장한 게 `web3.utils.toWei()`

```js
web3.utils.toWei("0.01", "ether");
```

이 함수는

- `"0.01"`이라는 **문자열 숫자**를
- `"ether"` 단위를 기준으로
- 내부적으로 정확한 **정수(Wei)** 값으로 변환해줍니다.

### 반환 값 예시:

```js
"10000000000000000";
```

즉, 이 코드를 쓰면  
**사람이 이해하기 쉬운 숫자 → 블록체인이 이해할 수 있는 숫자**로 자동 변환되는 겁니다.

## 구조 요약

```js
web3.utils.toWei(금액, 단위);
```

| 매개변수  | 설명                                            |
| --------- | ----------------------------------------------- |
| `"0.01"`  | 문자열로 된 금액 (실수형은 지양)                |
| `"ether"` | 어떤 단위에서 변환할지 (`ether`, `gwei`, `wei`) |

## 실전 정리

| 의도          | 사용 코드                                  |
| ------------- | ------------------------------------------ |
| 0.01 ETH 전송 | `value: web3.utils.toWei("0.01", "ether")` |
| 1 ETH 전송    | `value: web3.utils.toWei("1", "ether")`    |
| 100 gwei 전송 | `value: web3.utils.toWei("100", "gwei")`   |

## 주의: 소수점은 JS 내부에서만 쓰세요

Solidity 안에서는 `0.01 ether`처럼 쓰는 게 가능하지만  
JS에서는 반드시 `toWei()`를 통해  
**정확하고 안전한 방식으로 변환**하는 것이 표준입니다.

## 한 문장 요약

> `web3.utils.toWei()`는 사람이 입력한 ETH 금액을  
> **정확한 Wei 단위의 정수로 바꿔주는 변환기**입니다.  
> **블록체인에게 금액을 전할 땐 반드시 이 과정을 거쳐야 합니다.**
