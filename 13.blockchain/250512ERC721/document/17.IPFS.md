좋습니다. 요청하신 구조에 맞춰서, 도입부를 명확히 깔고 질문 중심으로 흐름을 전개하는 방식으로 IPFS 정리 글을 다시 구성하겠습니다.

---

# 17. IPFS에 대한 정리

---

오늘 수업에서 우리는 NFT를 만들고, 그 안의 이미지와 메타데이터를 연결하는 실습을 진행했죠?
그 과정에서 꼭 등장하는 시스템이 **IPFS**였습니다.

그런데, 막상 IPFS를 공부하려고 하면 이런 질문들이 생깁니다.

## 자주 나오는 질문들

- “왜 굳이 IPFS를 써야 하나요?”
- “IPFS도 결국 누군가의 서버 아닌가요?”
- “AWS에 올리면 안 돼요?”
- “파일을 올렸는데, 왜 나중에 안 열려요?”
- “IPFS도 꺼지면 끝 아닌가요?”

이 질문들 모두 너무 좋은 질문입니다.  
그리고 오늘 이 장에서 우리는 **이 질문들에 대해 구조적으로, 철학적으로, 기술적으로** 모두 정리합니다.

## 핵심은 두 가지입니다

1. **IPFS는 전 세계 노드들이 ‘내용’을 기준으로 파일을 주시하고 공유하는 거대한 분산 저장소입니다.**

2. **IPFS 주소는 ‘파일 내용의 해시값’으로 결정되기 때문에, 내용이 바뀌면 주소도 바뀌며,  
   그 결과로 ‘무결성 검증’이 자동으로 이루어집니다.**

---

이 두 줄만 이해하면,  
IPFS가 왜 만들어졌고,  
왜 블록체인 기반 시스템들이 IPFS를 쓰는지,  
그리고 기존 웹 서버(AWS 등)와 뭐가 다른지가 모두 설명됩니다.

이제 하나씩 풀어볼게요.

## . 기존 웹은 위치 기반 신뢰입니다

우리가 평소 사용하는 웹 주소는 이렇게 생겼죠:

```
https://example.com/images/1.png
```

이 주소는 **위치**입니다.

- “example.com”이라는 서버에
- “images/1.png”라는 경로에
- 이미지가 있다는 뜻이죠

문제는 뭐냐면,  
**그 주소가 진짜 그 이미지를 가리킨다는 보장이 없다는 것**입니다.

- 서버 주인이 파일을 몰래 바꾸면?
- 파일을 지워버리면?
- 전혀 다른 내용을 같은 주소에 올리면?

→ 우리는 알 방법이 없습니다.  
→ 우리는 **내용이 아니라 위치를 신뢰하고 있는 것**입니다.

## . IPFS는 내용 기반 신뢰입니다

IPFS의 주소는 이렇게 생겼습니다:

```
ipfs://bafybeidw2nmvlgv7bbb7eveeuwrbv2x2f7xoh2pggn4aadu4zpgk7iu5cy/1.png
```

이 주소는 **위치가 아니라, 파일 내용의 해시값**입니다.

즉:

- IPFS에 파일을 올리면
- 그 파일의 내용을 해싱해서 \*\*CID (Content Identifier)\*\*를 만듭니다
- 이 CID가 곧 주소가 됩니다

그리고 중요한 건 이겁니다:

> ✅ **파일의 내용이 바뀌면 CID도 바뀐다.**
> ✅ **파일이 같다면, CID도 반드시 같다.**

이게 바로 IPFS가 제공하는 **무결성과 불변성**입니다.  
→ “이 주소가 진짜 그 파일이 맞는지”를 누구나 검증할 수 있는 구조

## . IPFS도 결국 서버잖아요? 그럼 꺼지면 끝 아닌가요?

좋은 질문입니다. 맞습니다.  
**IPFS도 결국 서버(노드)입니다.**

하지만 차이가 있습니다.

> IPFS는 하나의 서버가 아니라,  
> **전 세계에 퍼진 노드들이 파일을 공유하고 보존하는 시스템**입니다.

즉, 한 노드가 꺼져도  
→ 다른 노드들이 그 파일을 **pin**해놓았다면  
→ 여전히 파일은 살아있습니다.

## . pinning이란?

> “이 파일은 내가 책임지고 보관할게”
> → 이걸 선언하는 게 `pin`입니다.

- 아무도 pin하지 않은 파일은 결국 네트워크에서 사라질 수 있습니다
- 누군가 pin을 해줘야, 해당 CID를 요청했을 때 데이터가 응답됩니다

그래서 실무에서는 직접 노드를 돌리기보다는  
**Pinata, NFT.Storage 같은 pinning 서비스를 이용합니다.**

## . 그래서 IPFS는 블록체인과 왜 어울릴까요?

블록체인은 **데이터의 상태를 기록하는 시스템**입니다.  
→ 누가 어떤 NFT를 가지고 있는지  
→ 언제 거래했는지  
→ 얼마의 잔액이 있는지

하지만 이미지를 직접 저장하지는 않습니다.  
→ 너무 무겁고, 비싸고, 유연하지 않기 때문입니다.

그래서 우리는 이런 조합을 만듭니다:

```
블록체인: 상태값 저장 (tokenId, owner 등)
→ tokenURI: ipfs://bafy.../1.json
→ JSON: 메타데이터, 이미지 경로 포함
→ image: ipfs://Qmabc.../1.png
```

이 구조에서 IPFS는  
**NFT의 실체**를 담는 저장소가 됩니다.

블록체인은 **누가 무엇을 소유했는지**,  
IPFS는 **그게 어떤 모습이었는지**를 담고 있는 셈이죠.

## . IPFS는 블록체인인가요?

아니요. 하지만 구조는 굉장히 유사합니다.

| 요소           | 블록체인                    | IPFS              |
| -------------- | --------------------------- | ----------------- |
| 주소           | 해시값 기반 (block hash 등) | 해시값 기반 (CID) |
| 검증 방식      | 해시 비교                   | 해시 비교         |
| 불변성         | 있음                        | 있음              |
| 순서/시간      | 있음 (블록 높이, timestamp) | 없음 (정적 구조)  |
| 상태 변화      | 있음                        | 없음              |
| 분산 노드 구조 | 있음                        | 있음              |
| 탈중앙 저장    | O                           | O                 |

즉, IPFS는 **블록은 없지만, 블록체인과 똑같은 신뢰 철학을 공유하는 시스템**입니다.

## . 그럼 이걸 어떻게 쓰나요?

개발자는 보통 이렇게 사용합니다:

1. 이미지 파일을 Pinata 등에 올림 → CID 획득
2. 그 CID를 `image` 필드에 넣고 JSON 생성
3. 그 JSON을 다시 IPFS에 올림 → 또 다른 CID 획득
4. 이 JSON CID를 스마트 컨트랙트의 `tokenURI()`에 연결

예:

```json
{
  "name": "My NFT #1",
  "description": "첫 번째 NFT입니다.",
  "image": "ipfs://Qmabcdef.../nft1.png",
  "attributes": [{ "trait_type": "Hat", "value": "Red" }]
}
```

## . 그런데 브라우저에서 `ipfs://` 주소는 안 열리던데요?

맞습니다.  
브라우저는 `ipfs://`를 이해하지 못합니다.  
그래서 **Gateway**라는 중간 서비스가 필요합니다.

예:

```
https://gateway.pinata.cloud/ipfs/bafy.../1.json
https://cloudflare-ipfs.com/ipfs/bafy.../1.json
```

→ 이건 `ipfs://...` 주소를 **HTTP로 바꿔주는 중계기**입니다.  
→ 브라우저 확인용일 뿐, 실제 스마트 컨트랙트에는 여전히 `ipfs://`를 써야 합니다.

## 정리

| 개념          | 설명                                           |
| ------------- | ---------------------------------------------- |
| IPFS          | 내용 기반 분산 파일 시스템                     |
| CID           | 파일 내용을 해싱한 고유 주소                   |
| pinning       | 해당 파일을 특정 노드가 영구 보관하도록 설정   |
| Gateway       | 브라우저가 `ipfs://` 주소를 열 수 있도록 중계  |
| 블록체인 연동 | 블록체인은 상태를, IPFS는 콘텐츠 정체성을 저장 |

## 한 줄 요약

> **IPFS는 파일 자체를 믿는 구조이고,
> 그 철학은 블록체인의 신뢰 방식과 정확히 일치한다.**

그래서 Web3 세계에서,  
NFT, DAO, DApp 등 **진짜 '디지털 자산'을 다루는 모든 구조에서**  
IPFS는 더 이상 선택이 아니라 **전제가 된다.**
