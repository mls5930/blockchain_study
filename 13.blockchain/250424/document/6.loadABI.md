# ABI 불러오기 – 스마트 컨트랙트와 대화하려면 설명서가 필요해요

## 우리가 스마트 컨트랙트랑 대화를 하려면?

이제 web3 인스턴스도 만들었고,  
컨트랙트 주소도 입력받을 준비가 되어있어요.

근데 잠깐!  
우리가 그 컨트랙트랑 **어떻게 대화하는지**,  
즉, **어떤 함수가 있고, 파라미터는 무엇이며, 어떤 반환값이 오는지** 모른다면?

> 웹3는 아무것도 할 수 없습니다.

그래서 필요한 게 바로...

### ABI (Application Binary Interface)

어김없이 **얘가 필요합니다.**  
우리의 `.sol` 파일은 단순한 Solidity 코드였지만,  
그걸 컴파일하면 **바이트 코드**와 함께,  
이 바이트 코드를 **사람과 기계가 이해할 수 있게 정리한 덩어리**,  
바로 **ABI**가 나옵니다.

---

### 브라우저는 모른다

지금 우리가 배포한 컨트랙트는  
**Sepolia 네트워크에 올라가 있고,  
그 안에서 EVM이 실행 중이며,  
ABI와 bytecode도 블록체인 상태(state)에 저장되어 있습니다.**

하지만...

> 지금 상호작용하려는 주체는 **브라우저**입니다.

브라우저는 Solidity도 모르고, 바이트 코드도 못 읽습니다.  
**bytecode만 보고는** 절대 이런 걸 알 수 없습니다:

- 어떤 함수들이 있는지
- 각 함수에 필요한 파라미터는 뭔지
- 그 함수가 view인지, payable인지
- 리턴값의 타입은 무엇인지

---

그래서 이걸 모르면?

> `web3`는 **"어떤 명령을 호출해야 할지"도 모르고**,  
> 결국 컨트랙트 주소는 알지만,  
> **"무엇을 어떻게 호출할지"는 몰라서 대화를 못 하게 됩니다.**

---

### 그래서 우리는 ABI가 필요하다

우리가 만든 `loadABI()` 함수는  
**이 ABI 파일을 브라우저로 불러오는 역할**을 합니다.

이걸 통해서만  
→ JavaScript에서 web3를 통해  
→ 컨트랙트의 함수들을 실제로 호출할 수 있는 기반이 만들어집니다.

## 그래서 이걸 함수로 만든 겁니다

우리가 직접 ABI 파일을 불러오고,  
**전역 변수로 저장해놓는 함수**,  
그게 바로 `loadABI()`입니다.

```js
let contractABI = null;

async function loadABI() {
  if (!contractABI) {
    const response = await axios.get("./contracts_Counter_sol_Counter.abi");
    contractABI = response.data;
  }
}
```

## 그런데… `let`? 왜 썼을까요?

제가 평소에 여러분한테 뭐라고 했죠?

> **"let 쓰지 마세요. 가능하면 const로, 진짜 필요한 상황 아니면 var도 let도 쓰지 마세요."**

그런데 위 코드에서는 `let`을 썼습니다.  
왜일까요?

### 납득시켜드리겠습니다.

**첫째**,

이 변수는 함수 바깥에서도 접근해야 하는 **전역 변수**입니다.  
`const`로 선언하면 **한 번 값이 지정된 후 재할당이 불가능**합니다.  
그런데 우리는 조건에 따라 `contractABI = response.data`처럼  
**값을 나중에 할당하는 구조**를 가지고 있죠. 그래서 `const`를 쓸 수 없습니다.

**둘째**,

`contractABI`는 최초 한 번만 불러오고,  
이후엔 재요청을 하지 않도록 조건문(`if (!contractABI)`)으로 제어하고 있습니다.  
즉, 불필요한 중복 요청을 막기 위한 구조적 이유가 있습니다.

---

저도 마찬가지입니다.

> 만약 여러분 코드에 `let`이 보인다?

무조건 물어볼 겁니다.

> **"왜 let 썼죠?"**

그때 여러분이  
**"이건 이렇게 동작해야 해서 let을 써야 했습니다"**  
라고 저를 납득시킨다면 저는 받아들일 겁니다.

하지만 그냥

> “습관이에요”, “몰라요”  
> 라면... 납득되기 어려울 것 같아요.

---

이걸 강조하는 이유는 단 하나입니다.

> **코드는 동작보다 의도가 더 중요하다.**  
> 그리고 그 **의도는 반드시 설명 가능해야 한다.**
