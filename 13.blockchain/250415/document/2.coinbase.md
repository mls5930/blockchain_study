# 그 전에! 코인베이스란 무엇인가요?

---

## 우리는 이미 ‘채굴’을 배웠습니다

- 이전 수업에서 우리는 **채굴(Mining)**,  
  즉 블록을 생성하고 **해시 문제를 푸는 행위**가  
  네트워크 전체를 유지하는 핵심이라는 걸 배웠습니다.

---

## 그런데 이런 질문이 생길 수 있어요

> **“블록을 만들면 보상을 준다던데, 그 보상은 누가 주는 거예요?”**  
> **“내가 만든 블록에다가, ‘나한테 50코인 주세요~’ 라고 적어도 되는 건가요?”**

## 네, 맞습니다.

바로 그 **“나한테 주세요”**를 적는 트랜잭션이  
우리가 만들 **코인베이스 트랜잭션(Coinbase Transaction)**입니다.

하지만 오해하지 마세요.  
이건 단순히 “내가 보상 적었다고 해서 받는 구조”가 아닙니다.

비트코인처럼 **PoW 방식을 채택한 블록체인에서는**,  
**블록 생성에 성공한 채굴자에게 보상을 주는 구조가 합의**되어 있습니다.

그 보상은 반드시

> **“코인베이스 트랜잭션”이라는 특별한 트랜잭션**으로 지급됩니다.

## 쉽게 말해 볼게요

> **“누구든 유효한 블록을 만들면, 50코인을 가져가도 돼!”**  
> → 이것이 PoW 시스템이 전제로 삼는 보상 약속입니다.

그래서 블록을 만들 때 가장 먼저  
**그 보상을 기록하는 트랜잭션을 넣는 것**이  
바로 **코인베이스 트랜잭션**입니다.

## 이 트랜잭션은 이렇게 생겼습니다

- **입력값(TxIn)이 없습니다.**  
  → 왜냐하면 참조할 UTXO가 없기 때문입니다.  
  → 코인베이스 트랜잭션은 기존 잔액에서 꺼내는 구조가 아니라,  
   **PoW 합의에 따라 새로 생성되는 보상 코인**을 기록하는 방식이기 때문입니다.

  일반 트랜잭션에서는  
  → “누가 얼마를 보냈는지”를 증명하기 위해 반드시 입력값이 필요하지만,  
  코인베이스 트랜잭션에서는  
  → **“블록을 만든 자격” 자체가 새 코인을 만들 수 있는 권리로 인정**됩니다.

  그래서 입력값 없이도,  
  **시스템 전체가 이 트랜잭션을 유효하다고 인정**합니다.

- **출력값(TxOut)은 존재합니다.**  
  → **채굴자의 지갑 주소로 50코인을 지급**합니다.

- 해시를 포함한 트랜잭션 전체는  
  → **일반 트랜잭션과 동일한 방식으로 블록 안에 포함**됩니다.

---

## 정리하자면

| 질문                       | 답변                                                            |
| -------------------------- | --------------------------------------------------------------- |
| 누가 코인을 주나요?        | **채굴자 본인이 스스로 보상 트랜잭션을 작성**합니다.            |
| 그게 허용되나요?           | **블록 생성 조건을 충족했기 때문에, 모든 노드가 인정**해줍니다. |
| 그럼 아무나 적어도 되나요? | **아니요! 채굴에 성공한 사람만 가능**합니다.                    |

---

## 그래서 코인베이스 트랜잭션은…

- PoW 블록체인 시스템의 **합의된 보상 구조**에 따라
- **새로운 코인을 발행하여 채굴자에게 보상을 지급**하는 트랜잭션입니다.

> 이 구조는 블록마다 단 1회만 생성 가능하며,  
> 입력 없이 출력만 존재하는 **특수한 트랜잭션**입니다.

- **비트코인에서는 이 구조를 통해서만** 새 코인이 공급됩니다.  
  → 일반 사용자의 트랜잭션에서는 새로운 코인이 만들어지지 않습니다.

---

## 이 흐름이 왜 중요한가요?

우리는 지금까지 다음과 같은 흐름을 배워왔습니다:

1. 사용자가 트랜잭션을 생성하고
2. 이 트랜잭션이 **트랜잭션 풀에 대기**하고 있다가
3. 채굴자가 트랜잭션들을 모아 **블록 후보(block candidate)** 를 만들고
4. 블록이 **난이도 조건을 만족할 때까지 해시 퍼즐을 풀고**
5. 최초로 정답을 찾은 채굴자가 **블록을 전파하면**
6. 다른 노드들이 이 블록을 **검증하고 체인에 추가**합니다
7. 블록에 포함된 트랜잭션은  
   → **풀에서 제거되고**  
   → **UTXO 상태가 갱신되며**  
   → **잔액 정보에 반영**됩니다

그런데 여기서 한 가지 빠진 게 있죠?

> 바로 이 블록을 만든 **채굴자에게 보상**을 주는 구조입니다.

이때 그 보상을 기록하는 트랜잭션이 바로

> **코인베이스 트랜잭션**입니다.

## 그래서 코인베이스는 흐름상 어디에 있나요?

- 블록을 만들 때 **가장 먼저 삽입되는 트랜잭션**입니다.
- 채굴자의 노고를 보상하는 **보상 메커니즘의 핵심**입니다.

이 코인베이스 트랜잭션까지 구현함으로써  
우리는 마침내 블록체인의 생명 주기를 완성하게 됩니다.

## 전체 생명 주기 요약

> **트랜잭션 생성** → **트랜잭션 수집** → **블록 생성** →  
> **코인베이스 보상 기록** → **블록 전파** → **잔액 반영(UTXO)**

이제 비로소,  
우리가 만드는 블록체인 시스템은  
**스스로 보상을 기록하고**,  
**다음 생성을 준비하는 자율 구조**를 갖추게 된 것입니다.
